### 第二章 命令插件的功能

>&emsp;&emsp;上一章我们谈到过，MMM的插件分为命令插件和常驻插件。在这一章，我们主要讲一讲命令插件都有些什么特点，适合用在什么地方。

>&emsp;&emsp;命令插件通常适用于进行批处理的工作，比如所有MMD制作者都知道的一个功能：RandomBlink（随机注册眨眼）。在这一章中，我们不仅仅会针对RandomBlink插件进行分析，还会尝试制作一个类似的插件。

#### 第一节 命令插件工作原理

&emsp;&emsp;首先让我们来复习一下命令插件的组成：

|方法或属性|描述|
|---|---|
|Guid GUID{get;}|插件的唯一识别标识，必须确保和其他的插件不同，建议随机生成！|
|IWin32Window ApplicationForm { get; set; }|获取MMM窗口句柄，用来用于弹提示消息框之类的，不必要掌握，会抄个弹窗写法就行|
|Scene Scene{get;set;}|相当重要的属性，用来获取MMM中的场景对象，以后打交道最多的值之一，必须熟悉它的结构和作用|
|string Description{get;}|插件介绍属性，你只需要把自己插件的介绍写在里面就行了，不是很重要
|Image Image{get;}|插件按钮的图标，可以留空，如果有的话，建议使用32*32大小|
|Image SmallImage{get;}|显示在命令栏中的图标，可以留空，如果有的话，建议使用32*32大小|
|string Text|显示在按钮上的文字（日语环境）|
|string EnglishText|显示在按钮上的文字（英语环境）|
|Void Run(CommandArgs e)|按下按钮后执行的操作，最重要的地方，命令插件相关功能全部在这里实现|
|Void Dispose()|非常重要的部分，在撤除插件时，你需要把所有插件有关的对象全部销毁掉，避免插件撤销后发生错误|

&emsp;&emsp;让我们将重点放在Run这个函数上：

|方法或属性|描述|
|---|---|
|Void Run(CommandArgs e)|按下按钮后执行的操作，最重要的地方，命令插件相关功能全部在这里实现|

&emsp;&emsp;函数名Run，参数ComandArgs，其实就已经说明了命令插件的工作原理了。不明白？让我们一起来看看吧！

&emsp;&emsp;首先是函数名Run，命令插件的业务逻辑就放在这个函数中，当MMM本体或者其它插件需要调用这个这个插件的功能时，就只需要**Run**一下这个插件，就完成了所有功能了。而这个参数**ComandArgs**则是在**Run**时所需要的数据，**Run**要如何执行就需要看**ComandArgs**输入的是什么了。

&emsp;&emsp;一言以蔽之，命令插件就是一道即时执行的指令，执行一次，就完成了对工程的修改，如果不再次运行，之后都不会再起作用。命令插件工作的时间只有开始执行的那一瞬间而已。

&emsp;&emsp;上一章中的小实践就是一道简单的命令，在点击的瞬间弹出一个窗口，就完成了这个命令插件的全部过程。接下来，我们将着手做一个**倒立旋转插件**，在完成之后，我们还会来分析一些较为复杂的官方Demo（官方Demo虽说不复杂，但要完全看明白需要同时知道不少东西……不具备学习时教授知识的去耦合性）。

#### 第二节 倒立旋转插件示例

&emsp;&emsp;首先先按照上一章的方法创建好工程，直到开始在Run函数中开始写代码的部分。

&emsp;&emsp;首先让我们来思考一下倒立旋转需要做一些什么事情。要让模型全身进行旋转等操作，肯定脱离不了
